\section{Question 3}

\begin{question}
    Derive the general system of equations that can be solved to obtain a cubic spline made up of $n$ cubic polynomials $S_j(x) = a_j+b_j(x-x_j)+c_j(x-x_j)^2+d_j(x-x_j)^3$ for a given function $f$ over an interval divided into $n$ subintervals by the points $x_0, x_1, x_2, \dots, x_n$. Use the not-a-knot boundary conditions.
    
    (not-a-knot condition: ${s_0}^{'''}(x_1) = {s_1}^{'''}(x_1)$; ${s_n}^{'''}(x_{n-1}) = {s_{n-1}}^{'''}(x_{n-1})$)
\end{question}

\begin{answer}
    We will use the first and last polynomials to derive the general system of equations:
    \begin{align}
        S_0(x) &= a_0 + b_0(x-x_0) + c_0(x-x_0)^2 + d_0(x-x_0)^3\\
        S_{n-1}(x) &= a_{n-1} + b_{n-1}(x-x_{n-1}) + c_{n-1}(x-x_{n-1})^2 + d_{n-1}(x-x_{n-1})^3
    \end{align}
    Then, these two polynomials need to satisfy the following conditions:
    \begin{align}
        S_0(x_0) = f(x_0) &\Rightarrow a_0 = f(x_0)\\
        S_0(x_1) = f(x_1) &\Rightarrow a_0 + (x_1-x_0)b_0 + {(x_1-x_0)}^2c_0 + {(x_1-x_0)}^3d_0 = f(x_1)\\
        S_{n-1}(x_{n-1}) = f(x_{n-1}) &\Rightarrow a_{n-1} = f({x_{n-1}})\\
        S_{n-1}(x_n) = f(x_n) &\Rightarrow a_{n-1} + (x_n - x_{n-1})b_{n-1} + {(x_n-x_{n-1})}^2c_{n-1} + {(x_n - x_{n-1})}^3d_{x_{n-1}} = f{x_n}
    \end{align}
    Computing the first and second polynomials of the first two polynomials, we have
    \begin{align}
        {S_0}^{'}(x) &= b_0 + 2c_0(x-x_0) + 3d_0(x-x_0)^2\\
        {S_0}^{''}(x) &= 2c_0 + 6d_0(x-x_0)\\
        {S_1}^{'}(x) &= b_1 + 2c_1(x-x_1) + 3d_1(x-x_1)^2\\
        {S_1}^{''}(x) &= 2c_1 + 6d_1(x-x_1)
    \end{align}
    Using this information, we further know that the cubic polynomials follow the conditions:
    \begin{align}
        {S_0}^{'}(x_1) = {S_1}^{'}(x_1) &\Rightarrow b_0 + 2c_0(x_1-x_0) + 3d_0(x_1-x_0)^2 = b_1\\
        &\Rightarrow b_0 + 2c_0(x_1-x_0) + 3d_0(x_1-x_0)^2 - b_1 = 0\\
        {S_0}^{''}(x_1) = {S_1}^{''}(x_1) &\Rightarrow 2c_0 + 6d_0(x_1-x_0) = 2c_1\\
        &\Rightarrow 2c_0 + 6d_0(x_1-x_0) - 2c_1 = 0
    \end{align}
    In order to use the not-a-knot condition, we need to first compute the third order derivatives of the first two and the last two polynomials:
    \begin{align}
        {S_0}^{'''}(x) &= 6d_0\\
        {S_1}^{'''}(x) &= 6d_1\\
        {S_{n-2}}^{'}(x) &= b_{n-2} + 2c_{n-2}(x-x_{n-2}) + 3d_{n-2}(x-x_{n-2})^2\\
        {S_{n-1}}^{'}(x) &= b_{n-1} + 2c_{n-1}(x-x_{n-1}) + 3d_{n-1}(x-x_{n-1})^2\\
        {S_{n-2}}^{''}(x) &= 2c_{n-2} + 6d_{n-2}(x-x_{n-2})\\
        {S_{n-1}}^{''}(x) &= 2c_{n-1} + 6d_{n-1}(x-x_{n-1})\\
        {S_{n-2}}^{'''}(x) &= 6d_{n-2}\\
        {S_{n-1}}^{'''}(x) &= 6d_{n-1}
    \end{align}
    Therefore, the not-a-knot condition gives us the equations:
    \begin{align}
        {s_0}^{'''}(x_1) = {s_1}^{'''}(x_1) &\Rightarrow 6d_0 = 6d_1 \Rightarrow d0 = d1\\
        {s_n}^{'''}(x_{n-1}) = {s_{n-1}}^{'''}(x_{n-1}) &\Rightarrow 6d_{n-1} = 6d_1 \Rightarrow d0 = d1
    \end{align}
\end{answer}